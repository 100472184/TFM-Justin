# CVE-2023-50246: Partial Context with Vulnerable File

## Vulnerability Summary
- **Type:** Heap-based buffer overflow (CWE-122)
- **Location:** `src/decNumber/decNumber.c` line ~3764
- **Function:** `decToString`
- **Trigger:** Malformed JSON numeric values

## Call Stack (from ASan report)

```
#0 decToString       /src/decNumber/decNumber.c:3764
#1 decNumberToString /src/decNumber/decNumber.c:449
#2 jvp_literal_number_literal /src/jv.c:653
#3 jv_number_get_literal /src/jv.c:668
#4 jv_dump_term      /src/jv_print.c:231
#5 jv_dumpf          /src/jv_print.c:368
#6 jv_dump           /src/jv_print.c:372
#7 process           /src/main.c:207
#8 main              /src/main.c:724
```

## Technical Context

**Vulnerable code path:**
1. jq parses a JSON file containing numeric values
2. Numbers are stored in internal decimal representation
3. When outputting (dumping), `decNumberToString` is called
4. This calls `decToString` which converts to character buffer
5. **BUG:** Buffer size calculation is incorrect for certain number formats
6. Write exceeds allocated buffer â†’ heap-buffer-overflow

**Buffer allocation issue:**
- The `decToString` function underestimates required buffer size
- Certain numeric representations require more characters than allocated
- This causes a WRITE overflow at the end of the allocated region

## Fuzzing Strategy Hints

**Effective mutations for this CVE:**
- Create JSON with very large numbers (many digits)
- Use numbers with extreme exponents (e.g., `1e9999`)
- Combine precision with scale (e.g., `0.00000001e100`)
- The PoC is available at: `https://github.com/SEU-SSL/Poc/raw/main/jq/`

**Mutation approach:**
- Start with a simple valid JSON: `{"n": 123}`
- Mutate the numeric value to extreme representations
- Try: large integers, tiny decimals, scientific notation extremes

**Size hints:**
- The PoC file is relatively small (under 1KB)
- It's the content format, not size, that triggers the bug
