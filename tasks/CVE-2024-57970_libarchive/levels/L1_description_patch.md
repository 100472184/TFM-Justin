# CVE-2024-57970: Patch Information

## Upstream Fix
- **Pull Request:** libarchive #2422 - "Handle truncation in the middle of a GNU long linkname"
- **Resolves:** Issue #2415 (ASan heap-buffer-overflow in `header_gnu_longlink`)
- **Merged:** Dec 10, 2024
- **Release:** libarchive 3.7.8 (security release)

## Patch Behavior

**Before (vulnerable):**
- TAR reader assumes complete long-linkname data available
- Uses incomplete buffers as complete strings → heap over-read
- No validation when archive truncates mid-stream

**After (fixed):**
- Validates long-linkname data completeness
- Treats truncated data as error
- Prevents buffer over-read on incomplete input

## General Vulnerability Concept

**Attack surface:** TAR archive parsing in extended header handling

**Vulnerability mechanism:**
- TAR archives can contain extended headers for metadata
- Parser may fail to validate data completeness
- Incomplete structures can cause buffer over-read during parsing

## Fuzzing Strategy Hint

**Effective approach for this CVE:**
- The vulnerability triggers on truncated archives
- Use `truncate` operation - simple truncation is sufficient
- Exploit size is significantly smaller than base seed (3KB)
- Do NOT corrupt headers or checksums - this breaks parsing
