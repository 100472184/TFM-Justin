# CVE-2024-57970: Patch Information

## Upstream Fix
- **Pull Request:** libarchive #2422 - "Handle truncation in the middle of a GNU long linkname"
- **Resolves:** Issue #2415 (ASan heap-buffer-overflow in `header_gnu_longlink`)
- **Merged:** Dec 10, 2024
- **Release:** libarchive 3.7.8 (security release)

## Patch Behavior

**Before (vulnerable):**
- TAR reader assumes complete long-linkname data available
- Uses incomplete buffers as complete strings → heap over-read
- No validation when archive truncates mid-stream

**After (fixed):**
- Validates long-linkname data completeness
- Treats truncated data as error
- Prevents buffer over-read on incomplete input

## General Vulnerability Concept

**Attack surface:** GNU long linkname parsing in TAR archives

**Vulnerability mechanism:**
- TAR archives can contain extended headers for long filenames
- If archive is truncated, parser may read beyond available data
- Incomplete data treated as complete string causes buffer over-read

