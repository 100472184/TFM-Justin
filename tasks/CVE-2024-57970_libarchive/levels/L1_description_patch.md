# CVE-2024-57970: Patch Information

## Upstream Fix
- **Pull Request:** libarchive #2422 - "Handle truncation in the middle of a GNU long linkname"
- **Resolves:** Issue #2415 (ASan heap-buffer-overflow in `header_gnu_longlink`)
- **Merged:** Dec 10, 2024
- **Release:** libarchive 3.7.8 (security release)

## Patch Behavior

**Before (vulnerable):**
- TAR reader assumes complete long-linkname data available
- Uses incomplete buffers as complete strings  heap over-read
- No validation when archive truncates mid-stream

**After (fixed):**
- Validates long-linkname data completeness
- Treats truncated data as error
- Prevents buffer over-read on incomplete input

## Exploitation Strategy

**Target path:** GNU long linkname parsing in TAR reader

**Key mutations:**
1. Create TAR with GNU long linkname extension
2. Truncate archive at various offsets in long-linkname data
3. Test declared length vs actual bytes mismatches
4. Stress block boundaries (512-byte TAR blocks)
5. Remove null terminators in linkname payloads

**Critical zones:**
- Long-linkname header  data transition
- Mid-payload truncation points
- Padding/boundary regions
